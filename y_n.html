<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>生命密码</title>
<script src="yournumber/util/vue.global.js"></script>
<script type="text/javascript" src="yournumber/util/lunar.js"></script>
<style>
td {
    text-align:center;
}
.table_title {
    font-size:20px;
    font-family: fantasy;
    text-align: left;
}
.short_input {
    width: 50px;
    text-align: center;
    height: 50px;
    font-size: xx-large;
    font-family: serif;
    border: 0px;
    border-bottom: 1px solid #CCC;
}
.main_num{
    color:red;
}
.user_input{
    border:1px solid #CCC;
    width: 100px;
    height: 90px;
    font-size: 50px;
}
.no_under_input{
    border:0px;
}
table{
    width: 100%;
    padding-left: 10%;
    padding-right: 10%;
}
.span_style{
    display: block;
}
#btn_span{
    position: absolute;
    margin-left: 15px;
    margin-top: 20px;    
}
#turn_to_solar{
    width:55px;
    height:55px;
}
.table_ana {
    text-align: left;
    border-collapse: collapse;
}
.table_ana td{
    text-align: left;
	border:1px solid #000000;
}
.table_ana .th_style{
	font-weight: 800;
}
.table_ana .main{
	color: red;
    font-weight: 700;
}
</style>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?08842a471bf2f86cded4a136d7687d35";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
	<div id="number_table">
    <table>
        <tr>
            <th colspan="9" class="table_title">生命密码计算:</th>
        </tr>
		<tr>
			<td colspan="9">请输入生日：<input type="text" id="birthday" name="birthday" ref="birthday" v-on:keyup="setInitBirth($event)" v-model="initBirth"/>
	<!-- 此处的功能和turnToSolar相同，去掉这个。
				<input type="button" id="change_to_solar" name="change_to_solar" value="转阳历" v-on:click="changeToSolar($event)" />
	-->
			</td>
		</tr>
        <tr>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="R" name="R" title="Q+P" v-model="lifeCode.R" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
        </tr>
        <tr>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="Q" name="Q" title="N+O" v-model="lifeCode.Q"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="P" name="P" title="M+O" v-model="lifeCode.P"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
        </tr>
        <tr>
            <td><input class="short_input" disabled="disabled" type="text" id="S" name="S" title="X+W" v-model="lifeCode.S"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="X" name="X" title="I+M" v-model="lifeCode.X"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="W" name="W" title="J+M" v-model="lifeCode.W"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input main_num" disabled="disabled" type="text" id="O" name="O" title="M+N" v-model="lifeCode.O"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="V" name="V" title="K+N" v-model="lifeCode.V"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="U" name="U" title="L+N" v-model="lifeCode.U"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="T" name="T" title="V+U" v-model="lifeCode.T"  /></td>
        </tr>
        <tr>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="M" name="M" title="I+J" v-model="lifeCode.M"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="N" name="N" title="K+L" v-model="lifeCode.N"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
        </tr>
        <tr>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="I" name="I" title="A+B" v-model="lifeCode.I"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="J" name="J" title="C+D" v-model="lifeCode.J"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="K" name="K" title="E+F" v-model="lifeCode.K"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="L" name="L" title="G+H" v-model="lifeCode.L"  /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
            <td><input class="short_input" disabled="disabled" type="text" id="" name="" /></td>
        </tr>
        <tr>
            <td colspan='2'><input class="short_input user_input" type="text" id="AB" name="AB" title="日期" @keyup="ABKeyup($event)" v-model="birthday.day" /><span class="span_style">(日期)</span></td>
            <td colspan='2'><input class="short_input user_input" type="text" id="CD" name="CD" title="月份" @keyup="CDKeyup($event)" v-model="birthday.month" /><span class="span_style">(月份)</span></td>
            <td><input class="short_input no_under_input" type="text" id="" name="" /></td>
            <td colspan='2' ><input class="short_input user_input" type="text" id="EF" name="EF" title="年份前两位" @keyup="EFKeyup($event)" v-model="birthday.year_b_2"  /><span class="span_style">(年份前两位)</span></td>
            <td colspan='2' >
				<input class="short_input user_input" type="text" id="GH" name="GH" title="年份后两位" @keyup="GHKeyup($event)" v-model="birthday.year_a_2"  />
				<span id="btn_span"><input type="button" name="turn_to_solar" id="turn_to_solar" value="转阳历" v-on:click="turnToSolar($event)" /></span>
				<span class="span_style">(年份后两位)</span></td>
        </tr>
    </table>
	</br>
	</br>
	<table class="table_ana">
			<thead>
				<tr class="th_style">
					<th>主性格</th>
					<th>性格正面</th>
					<th>性格负面</th>
				</tr>
			</thead>
			<tbody>
<template v-for="person in characterArr" :key="person.id">
				<tr :class="{main:trClass['isActivetr'+person.id]}">
					<td>{{ person.cNO }}</td>
					<td>{{ person.cPositive }}</td>
					<td>{{ person.cNegative }}</td>
				</tr>
</template>
			</tbody>
	</table>
	</br>
	</div>
<script type="text/javascript">
/**
 * @copyright (c) 2017, iloveyezi.cn All rights reserved.
 *
 * @file  y_n.html
 * @brief 根据用户输入计算生命密码 
 *        参考: <<数字心理学>> 作者:钟缮夤
 *        感谢: 魏福生
 * @author Bert
 * @date 2017-5-6
 */

//计算两数相加的结果
//0+0=5;
function num1to9(first, second){
    var ret = 0;
    if(first == 0 && second == 0){
        ret = 5;
    }
    else{
        ret = first+second;
    }
    if(ret > 9){
        ret = ret-9;
    }
    return ret;
}
function get_one_num(val){
    var ret_obj = {};
    if(val.toString().length == 2){
        ret_obj.first = parseInt(val.toString().substr(0, 1), 10);
        ret_obj.second = parseInt(val.toString().substr(1, 1), 10)
    }
    else{
        ret_obj.first = 0;
        ret_obj.second = parseInt(val, 10);
    }
    return ret_obj;
}
function get_num(ab_str, cd_str, ef_str, gh_str){
    var ret_obj = {a:0,b:1,c:0,d:6,e:1,f:9,g:8,h:6};
    //var ab_str = $("#AB").val();
    var ab_val = ab_str ? ab_str : 0;
    var ab_obj = get_one_num(ab_val);
    ret_obj.a = ab_obj.first;
    ret_obj.b = ab_obj.second;

    //var cd_str = $("#CD").val();
    var cd_val = cd_str ? cd_str : 0;
    var cd_obj = get_one_num(cd_val);
    ret_obj.c = cd_obj.first;
    ret_obj.d = cd_obj.second;

    //var ef_str = $("#EF").val();
    var ef_val = ef_str ? ef_str : 0;
    var ef_obj = get_one_num(ef_val);
    ret_obj.e = ef_obj.first;
    ret_obj.f = ef_obj.second;

    //var gh_str = $("#GH").val();
    var gh_val = gh_str ? gh_str : 0;
    var gh_obj = get_one_num(gh_val);
    ret_obj.g = gh_obj.first;
    ret_obj.h = gh_obj.second;
    return ret_obj;
}
//验证输入是否正确, 返回错误类型
//校验正确的年,月,日 TODO
function correct_input_num(num){
    var ret = 0; //正确的
    //长度最多为2位
    if(num.length > 2){
        ret = 1; //长度错误
    }
    //是数字
    if(isNaN(num)){
        ret = 2; //不是数字
    }
    return ret;
}
//根据错误类型返回正确的数字
function error_num_handling(num, error_type){
    var correct_ret = num;
    if(error_type === 1){
        correct_ret = num.toString().substr(0, 2);
    }
    else if(error_type === 2){
        correct_ret = parseInt(num, 10);
    }
    return correct_ret; 
}
//规范输入
function normalize_num(num){
    var ret_num;
    var check_ret = correct_input_num(num);
    if(check_ret === 0){
        ret_num = num;
    }
    else{
        ret_num = error_num_handling(num, check_ret);
    }
    return ret_num;
}
const lifeCodeApp = {
	data(){
		return {
			initBirth:'1986-06-01',
			trClass:{
				isActivetr1:false,
				isActivetr2:false,
				isActivetr3:false,
				isActivetr4:false,
				isActivetr5:false,
				isActivetr6:false,
				isActivetr7:false,
				isActivetr8:false,
				isActivetr9:false,
			},
			birthday:{
				day:'01',
				month:'06',
				year_b_2:'19',
				year_a_2:'86'
			},
			lifeCode:{
				I:1,
				J:6,
				K:1,
				L:5,
				M:7,
				N:6,
				O:4,
				P:2,
				Q:1,
				R:3,
				S:3,
				T:9,
				U:2,
				V:7,
				W:4,
				X:8
			},
			characterArr: [
				{
					id:1,
					cNO:'1号人',
					cPositive:'领导力、创造、自信、果断、专注、独立',
					cNegative:'自我、孤独、高傲自大、强势、自我中心'
				}, {
					id:2,
					cNO:'2号人',
					cPositive:'温和、有耐心、善解人意、善于合作、读心术、分析能力强',
					cNegative:'依赖、比较、易受影响、犹豫不决、优柔寡断'
				}, {
					id:3,
					cNO:'3号人',
					cPositive:'积极、执行力强、激情、激励、行动、表达、威信',
					cNegative:'冲动、没耐心、坏脾气、不专情、任性'
				}, {
					id:4,
					cNO:'4号人',
					cPositive:'学习力强、组织能力强、有条理、踏实稳重、善于策划、聪明、务实',
					cNegative:'心直口快、缺乏安全感、单刀直入、犹疑不定、悲观、保守'
				}, {
					id:5,
					cNO:'5号人',
					cPositive:'目标感强、方向感强、坚持、幽默感、自由自在、豪爽',
					cNegative:'固执、猜疑、冲动、面子、随心所欲'
				}, {
					id:6,
					cNO:'6号人',
					cPositive:'忠诚、远见、财富、洞察力、完美、发现问题、领悟力、无私奉献',
					cNegative:'浪费、挑剔、自负、易陷入细节'
				}, {
					id:7,
					cNO:'7号人',
					cPositive:'人缘好、博学、遇贵人、好奇心、好研究、乐于助人',
					cNegative:'不体贴、迟缓、冷淡、多疑'
				}, {
					id:8,
					cNO:'8号人',
					cPositive:'责任、权威、格局、抗压力、理想抱负、权力、亲善',
					cNegative:'压力、消极、野心、纠结'
				}, {
					id:9,
					cNO:'9号人',
					cPositive:'机会、正值、智慧、爱冒险、洞察力、察言观色、使命感',
					cNegative:'寂寞、无原则、贪心、不专精、脱离现实'
				}
			]
		}
	},
	methods:{
		domInit(){
			//初始值
			//me  01 06 19 88
			// var birth = {day:"01", month:"06", year: "1986"};
			//亲: 11 04 19 88;
			//var birth = {day:"11", month:"04", year: "1988"};
			//董: 28 07 19 77;
			// var birth = {day:"28", month:"07", year: "1977"};
			//Steve Jobs
			//var birth = {year: "1955", month:"02", day:"24" };
			//Today
			let dateObj = new Date();
			let year = dateObj.getFullYear();
			let month = dateObj.getMonth() + 1;
			let day = dateObj.getDate();

			let year_b_2 = year.toString().substr(0, year.toString().length-2);
			let year_a_2 = year.toString().substr(-2);

			this.initBirth = year + '-' + month + '-' + day;

			this.birthday.day = day;
			this.birthday.month = month;
			this.birthday.year_b_2 = year_b_2;
			this.birthday.year_a_2 = year_a_2;

			var ret_num = get_num(day, month, year_b_2, year_a_2);
			this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
		},
		calc_num(a, b, c, d, e, f, g, h){
			var i = num1to9(a,b);
			var j = num1to9(c,d);
			var k = num1to9(e,f);
			var l = num1to9(g,h);

			var m = num1to9(i,j);
			var n = num1to9(k,l);

			var o = num1to9(m,n);

			var w = num1to9(j,m);
			var x = num1to9(i,m);
			var s = num1to9(x,w);

			var v = num1to9(k,n);
			var u = num1to9(l,n);
			var t = num1to9(v,u);

			var q = num1to9(n,o);
			var p = num1to9(m,o);
			var r = num1to9(q,p);

			this.lifeCode.I = i;
			this.lifeCode.J = j;
			this.lifeCode.K = k;
			this.lifeCode.L = l;
			this.lifeCode.M = m;
			this.lifeCode.N = n;
			this.lifeCode.O = o;
			this.lifeCode.P = p;
			this.lifeCode.Q = q;
			this.lifeCode.R = r;
			this.lifeCode.S = s;
			this.lifeCode.T = t;
			this.lifeCode.U = u;
			this.lifeCode.V = v;
			this.lifeCode.W = w;
			this.lifeCode.X = x;

			this.setMainHl(o);
		},
		setMainHl(main_num){
			this.trClass.isActivetr1 = 1 == main_num ? true : false;
			this.trClass.isActivetr2 = 2 == main_num ? true : false;
			this.trClass.isActivetr3 = 3 == main_num ? true : false;
			this.trClass.isActivetr4 = 4 == main_num ? true : false;
			this.trClass.isActivetr5 = 5 == main_num ? true : false;
			this.trClass.isActivetr6 = 6 == main_num ? true : false;
			this.trClass.isActivetr7 = 7 == main_num ? true : false;
			this.trClass.isActivetr8 = 8 == main_num ? true : false;
			this.trClass.isActivetr9 = 9 == main_num ? true : false;
		},
		setInitBirth(event){
			// `methods` 内部的 `this` 指向当前活动实例
			// alert('Hello ' + this.name + '!') // Hello lifeCode
			// `event` 是原生 DOM event
			if (event) {
				//alert(event.target.value)
				//let birthday_val = event.target.value;

				//这里可以通过双向绑定的形式获取值
				let birthday_val = this.initBirth;
				let b_v_arr = birthday_val.split("-");

				//此次需要把获取的value写到对应的文本框中
				//var birth = {year: b_v_arr[0], month:b_v_arr[1], day:b_v_arr[2]};
				//init_birthday(birth);
				let day = b_v_arr[2];
				let month = b_v_arr[1];
				let year_b_2 = b_v_arr[0].toString().substr(0, b_v_arr[0].toString().length-2);
				let year_a_2 = b_v_arr[0].toString().substr(-2);

				this.birthday.day = day;
				this.birthday.month = month;
				this.birthday.year_b_2 = year_b_2;
				this.birthday.year_a_2 = year_a_2;

				var ret_num = get_num(day, month, year_b_2, year_a_2);
				this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
			}
		},
		toSolr(year, month, day){
			var solar_arr = Lunar.toSolar(year, month, day);
			if(solar_arr && solar_arr[0]){
				//从新赋值
				this.birthday.day = solar_arr[2];
				this.birthday.month = solar_arr[1];
				var solar_year = solar_arr[0].toString();
				this.birthday.year_b_2 = solar_year.substr(0, solar_year.length-2);
				this.birthday.year_a_2 = solar_year.substr(-2);
				var ret_num = get_num(this.birthday.day,this.birthday.month, this.birthday.year_b_2, this.birthday.year_a_2);
				this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
			}
			else{
				alert('转换错误,请您先输入阳历生日!');
			}
		},
		changeToSolar(event){
			let clickDom = event.currentTarget; // currentTarget 获取绑定点击事件的节点
			let previous = clickDom.previousElementSibling; // previousElementSibling获取绑定事件节点的前一个节点
			//alert(previous.value);
			//此处调用转阳历的方法，显示出阳历，用户输入的是农历，转为阳历
			//alert(this.$refs.birthday.value)
			let b_v = this.$refs.birthday.value;
			let b_v_arr = b_v.split("-");
			let year = b_v_arr[0];
			let month = b_v_arr[1];
			let day = b_v_arr[2]
			this.toSolr(year, month, day);
		},
		turnToSolar(event){
			this.toSolr(this.birthday.year_b_2.toString()+this.birthday.year_a_2, this.birthday.month, this.birthday.day);
		},
		ABKeyup(event){
			var ret_num = get_num(this.birthday.day,this.birthday.month, this.birthday.year_b_2, this.birthday.year_a_2);
			this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
		},
		CDKeyup(event){
			var ret_num = get_num(this.birthday.day,this.birthday.month, this.birthday.year_b_2, this.birthday.year_a_2);
			this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
		},
		EFKeyup(event){
			var ret_num = get_num(this.birthday.day,this.birthday.month, this.birthday.year_b_2, this.birthday.year_a_2);
			this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
		},
		GHKeyup(event){
			var ret_num = get_num(this.birthday.day,this.birthday.month, this.birthday.year_b_2, this.birthday.year_a_2);
			this.calc_num(ret_num.a, ret_num.b, ret_num.c, ret_num.d, ret_num.e, ret_num.f, ret_num.g, ret_num.h);
		}
	},
	mounted(){
		//自动加载indexs方法
		this.domInit();
	}
};
Vue.createApp(lifeCodeApp).mount('#number_table')
</script>
</body>
</html>
